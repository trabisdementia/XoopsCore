function module_Detail(t){var o=$("#mid-"+t).position();$("#detail-"+t).css({position:"absolute","box-shadow":"2px 2px 1px #888",top:o.top+"px",left:o.left+"px"}),$("#detail-"+t).slideDown(600)}function module_Disable(t,o,e){$.post("admin.php",{fct:"modulesadmin",op:"active",mid:t},function(n,i){"success"==i&&(n?($("#active-"+t).html('<span class="icon icon-tick"></span>'+o),$("#active-table-"+t).html('<span class="icon icon-tick">&nbsp;</span>')):($("#active-"+t).html('<span class="icon icon-cross"></span>'+e),$("#active-table-"+t).html('<span class="icon icon-cross">&nbsp;</span>')))})}function module_Hide(t){$.post("modules.php",{op:"display_in_menu",mid:t},function(o,e){"success"==e&&$("#menu-hide-"+t).html(0!=o?'<span class="cursorpointer icon icon-cross">&nbsp;</span>':'<span class="cursorpointer icon icon-tick">&nbsp;</span>')})}function module_Install(t){$(".modal-backdrop").show(),$("#install-dir").val(t),$("#install .modal-data").html($("#data-"+t+" .module_card").html()),$("#install").show("slow")}function module_Uninstall(t){$(".modal-backdrop").show(),$("#uninstall-id").val(t),$("#uninstall .modal-data").html($("#data-"+t+" .module_card").html()),$("#uninstall").show("slow")}!function(t){function o(o){t("body").xoPreload();var e={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:"update",mid:o};return t.post("modules.php",e,function(o){if(!xoops.AJAX.retrieve(o))return t("body").xoPreload({action:"hide"}),!1;if(t("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:o.title,message:o.content,color:"primary",id:"module-logger",buttons:{main:{label:void 0!=o.close?o.close:xoLang.close,className:"btn-primary"}}}),t("#table-installed-modules")){var e=t(".xo-item-options a[data-action='module-update'][data-id='"+o.mid+"']");if(e.length<=0)return!1;e.parents("tr").find(".version").html(o.version),e.parents("tr").find(".updated").html(o.updated)}},"json"),!1}function e(o,e,n){var i={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:"change-view",logo_mode:n,mode:e,tab:t(".xo-moduleadmin-buttons .btn-primary").attr("href").replace("#","")};t(o).parent().xoSpinner({icon:"xicon-spinner-01",type:"spin",speed:4}),t.post("modules.php",i,function(e){return xoops.AJAX.retrieve(e)?("available"==e.list?t("#available-modules").html(e.content):t("#installed-modules").html(e.content),t(o).parent().xoSpinner(),void t("#view-canvas").data("mode",e.mode)):(xoops.notify({title:e.message.title,text:e.message.text,delay:7e3,type:"danger",nonblock:{nonblock:!0,nonblock_opactity:.2}}),t(o).parent().xoSpinner(),!1)},"json")}var n={};t(document).ready(function(){t("body").on("click","*[data-action]",function(){var o=t(this).data("id"),e=t(this).data("action").replace("-","_");return"function"==typeof n[e]?n[e](o):!1}),t("input[name='view_mode'],input[name='view_logo']").change(function(){var o=t("#view-canvas");if("view_mode"==t(this).attr("name")&&o.data("mode")==t(this).data("mode"))return!1;var n="view_mode"==t(this).attr("name")?t(this).data("mode"):t(".header-commands input[name='view_mode']:checked").data("mode"),i="view_logo"==t(this).attr("name")?t(this).data("mode"):t(".header-commands input[name='view_logo']:checked").data("mode");e(t(this),n,i)}),t(".rename").editable("modules.php?op=rename",{indicator:"<img src='../../media/xoops/images/spinner.gif'>",cssclass:"span2"}),t("body").on("click",'[data-action="module-info"]',function(){t("body").xoPreload();var o={XOOPS_TOKEN_REQUEST:t("#xoops-token").val(),op:"details",mid:t(this).data("mid")};return t.get("modules.php",o,function(o){return"error"==o.type?(xoops.modal.alert(o.message),t("body").xoPreload({action:"hide"}),!1):(xoops.modal.dialog({title:o.title,message:o.content,color:1==o.installed?"primary":"danger",id:"module-details",buttons:{main:{label:o.close,className:"btn-primary"}}}),void t("body").xoPreload({action:"hide"}))},"json"),!1}),t("body").on("click",'[data-action="module-update"]',function(){return confirm(xoLang.confirmUpdate)&&o(t(this).data("id")),!1}),t("body").on("click",'[data-action="module-uninstall"]',function(){if(!confirm(xoLang.confirmUninstall))return!1;t("body").xoPreload();var o={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:"uninstall",mid:t(this).data("id")};return t.post("modules.php",o,function(o){if(!xoops.AJAX.retrieve(o))return t("body").xoPreload({action:"hide"}),!1;if(t("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:o.title,message:o.content,color:"danger",id:"module-logger",buttons:{main:{label:void 0!=o.close?o.close:xoLang.close,className:"btn-primary"}}}),t("#table-installed-modules")){var e=t(".xo-item-options a[data-action='module-update'][data-id='"+o.mid+"']");if(e.length<=0)return!1;e.parents("tr").remove()}else t("#mid-"+o.mid).remove()},"json"),!1}),t("body").on("click",'#installed-modules [data-action="module-active"]',function(){if("module-disable"==t(this).data("action")&&!confirm(xoLang.confirmDisable))return!1;var o=t(this).data("id");if(void 0==o||0>=o)return xoops.notify({title:xoLang.error,text:xoLang.noId,addclass:"alert-danger",icon:"xicon-alert-triangle",opacity:1,nonblock:{nonblock:!1}}),!1;t("body").xoPreload();var e={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:"active",mid:o};return t.post("modules.php",e,function(o){if(!xoops.AJAX.retrieve(o))return xoops.modal.alert(o.message),t("body").xoPreload({action:"hide"}),!1;t("body").xoPreload({action:"hide"}),xoops.notify({title:xoLang.activationResult,text:o.message,addclass:1==o.active?"alert-success":"alert-warning",icon:"xicon-thumb-up",opacity:1,nonblock:{nonblock:!1}});var e=t("li.active-btn > [data-id='"+o.mid+"']");return e.length<=0?!1:void(1==o.active?(e.attr("title",xoLang.disable),e.attr("class","bg-warning"),xoops.loadIcon("xicon-pause-circle",e),e.parents("tr").removeClass("disabled")):(e.attr("title",xoLang.enable),e.attr("class","bg-success"),xoops.loadIcon("xicon-play-circle",e),e.parents("tr").addClass("disabled")))},"json"),!1}),t("body").on("click",'a[data-toggle="modules"]',function(){var o=t(this).attr("href"),e=t(this);if(t(e).siblings().removeClass("btn-primary"),t(o+"-modules").is(":visible"))return!1;var n={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:o.replace("#","")+"-modules"};return t(this).xoSpinner({type:"pulse",icon:"xicon-spinner-07",steps:9}),t.get("modules.php",n,function(n){return xoops.AJAX.retrieve(n)?(t(o+"-modules").html(n.content),t(e).xoSpinner(),e.addClass("btn-primary"),t(".modules-container > div").removeClass("active"),t(o+"-modules").addClass("active"),void("#installed"==o&&t(".rename").editable("modules.php?op=rename",{indicator:"<img src='../../media/xoops/images/spinner.gif'>",cssclass:"span2"}))):(t(e).xoSpinner(),!1)},"json"),!1}),t("body").on("click",'#available-modules [data-action="module-install"]',function(){if(!confirm(xoLang.confirmInstall))return!1;t("body").xoPreload();var o={XOOPS_TOKEN_REQUEST:t("#xo-token").val(),op:"install",dirname:t(this).data("dirname")};return t.post("modules.php",o,function(o){return xoops.AJAX.retrieve(o)?(t("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:o.title,message:o.content,color:"success",id:"module-logger",buttons:{main:{label:void 0!=o.close?o.close:xoLang.close,className:"btn-success"}}}),void t("#mid-"+o.dirname).remove()):(t("body").xoPreload({action:"hide"}),!1)},"json"),!1})})}(jQuery);
